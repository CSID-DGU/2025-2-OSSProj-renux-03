# Next Plan
- 작성일: 2025-10-13

## 1. POST /chat/new API 구현
- 백엔드에 채팅방 생성을 담당하는 엔드포인트(`/chat/new` 또는 합의된 경로)를 추가합니다.
- 요청 바디는 `{ orgId, title }` 형태의 JSON으로 받아서 유효성 검사를 수행합니다.
- 로그인 사용자 정보와 조직 ID를 기반으로 새로운 `ChatKind` 레코드를 생성하고, 기본 메시지 세팅이 필요하면 `ChatMessage`도 함께 저장합니다.
- 응답으로는 생성된 채팅방 ID를 포함한 JSON (`{ id, title, orgId }`) 을 반환하여 프런트가 즉시 라우팅할 수 있도록 합니다.
- 예외 처리 및 권한 검사를 통해 로그인된 사용자만 생성할 수 있게 제한합니다.

## 2. 채팅 화면 전환 로직 정리
- 프런트엔드에서 채팅방 생성 성공 시 `window.location.href = /chat/{id}` 호출 후 페이지가 해당 채팅 상세 화면을 로드하도록 라우팅을 정리합니다.
- 채팅 상세 페이지가 없다면, 단일 페이지 내에서 대화 영역을 초기화하고 소켓/폴링 로직을 연결해 새 대화를 바로 시작하도록 설계합니다.
- 새 채팅으로 전환될 때 기존 메시지 상태나 이벤트 리스너가 꼬이지 않도록 초기화 절차(메시지 리스트 clear, 입력 창 포커스, 소켓 room join 등)를 정의합니다.
- 로그인 사용자뿐 아니라 게스트 처리 방식을 결정하고, 비로그인 상태에서는 생성 자체를 막을지, 임시 세션으로 대화를 허용할지 정책을 문서화합니다.

## 3. `/req/orgs` 응답 포맷 확정 및 에러 처리 강화
- 학과 목록 응답에서 `id`, `major.majorname` 등 필수 필드를 모두 제공하는지 백엔드와 계약을 확정합니다.
- 응답이 비어 있거나 오류가 발생했을 때 프런트가 표시할 안내 문구/재시도 전략을 정의합니다.
- 필요 시 학과 데이터 캐싱 전략(페이지 초기 로드 vs. 모달 열릴 때 호출 등)을 검토해 UX를 다듬습니다.

## 4. 새 채팅 이후 실시간 연결 흐름 보완
- 새 채팅방으로 이동한 직후 메시지 스트림 초기화, 소켓 룸 조인, 로딩 인디케이터 노출 등을 설계합니다.
- `/chat/{id}` 진입 시 필요한 초기 데이터(기존 메시지, 공지 등)를 정의하고 프리패치 전략을 세웁니다.
- 오류 발생 시 사용자에게 재시도 옵션을 제공하고, 실패 로그를 서버에 남길 수 있도록 협의합니다.
